---
solution: Campaign Classic
product: campaign
title: 数据模型最佳实践
description: 了解活动数据模型扩展最佳实践
translation-type: tm+mt
source-git-commit: 779542ab70f0bf3812358884c698203bab98d1ce
workflow-type: tm+mt
source-wordcount: '2708'
ht-degree: 4%

---

# 数据模型最佳实践{#data-model-best-practices}

本文档概述设计Adobe Campaign数据模型时的主要建议。

Adobe Campaign系统非常灵活，可扩展到初始实现之外。 但是，尽管可能性是无限的，但做出明智决策并建立坚实的基础对于开始设计数据模型至关重要。

要更好地了解活动内置表及其交互，请参阅[本节](datamodel.md)。

：灯泡：阅读[本节](schemas.md)，开始使用活动模式。

：灯泡：了解如何配置扩展模式，以扩展[此页](extend-schema.md)中Adobe Campaign数据库的概念数据模型。

## 数据模型架构{#data-model-architecture}

Adobe Campaign是一个功能强大的跨渠道活动管理系统，可帮助您协调线上和线下战略以创建个性化的客户体验。

### 以客户为中心的方法{#customer-centric-approach}

虽然大多数电子邮件服务提供商都在通过以列表为中心的方法与客户进行通信，但Adobe Campaign依靠关系型数据库来充分利用客户及其属性的更广泛视图。

要访问每个表的说明，请转到&#x200B;**[!UICONTROL Admin > Configuration > Data schemas]**，从列表中选择一个资源并单击&#x200B;**[!UICONTROL Documentation]**&#x200B;选项卡。


>[!NOTE]
>
>Adobe Campaign允许生成[自定义收件人表](custom-recipient.md)。 但是，在大多数情况下，建议使用内置的[收件人表](datamodel.md#ootb-profiles)，该表已经预置了其他表和功能。

### Adobe Campaign{#data-for-campaign}的数据

应将哪些数据发送给Adobe Campaign? 确定营销活动所需的数据至关重要。

>[!NOTE]
>
>Adobe Campaign既不是data warehouse，也不是报告工具。 因此，请勿尝试将所有可能的客户及其关联信息导入Adobe Campaign，或导入仅用于构建报表的数据。

要决定Adobe Campaign中是否需要某个属性，请扪心自问，该属性是否属于以下类别之一：

* 用于&#x200B;**segmentation**&#x200B;的属性
* 用于&#x200B;**数据管理进程**&#x200B;的属性(例如聚合计算)
* 用于&#x200B;**个性化**&#x200B;的属性

如果不掉入其中任何一个，您很可能不需要在Adobe Campaign中使用此属性。

### 数据类型{#data-types}的选择

为确保系统的良好架构和性能，请按照以下最佳做法设置Adobe Campaign中的数据。

* 大表应大多包含数字字段，并包含指向引用表的链接(当使用值列表时)。
* **expr**&#x200B;属性允许将模式属性定义为计算字段，而不是表中的物理集值。 这可以使用不同格式（例如，年龄和出生日期）访问信息，而无需存储这两个值。 这是避免重复字段的好方法。 例如，收件人表使用域的表达式，该域已在电子邮件字段中显示。
* 但是，当表达式计算复杂时，不建议使用&#x200B;**expr**&#x200B;属性作为即时计算，这可能会影响查询的性能。
* **XML**&#x200B;类型是避免创建过多字段的好方法。 但当它使用数据库中的CLOB列时，它也占用了磁盘空间。 它还可能导致复杂的SQL查询，并可能影响性能。
* **string**&#x200B;字段的长度应始终由列定义。 默认情况下，Adobe Campaign的最大长度为255，但如果您已经知道大小不会超过较短的长度，则Adobe建议将字段保持较短。
* 如果您确定源系统中的字段大小被高估，并且无法达到，则可以将Adobe Campaign比源系统中的字段短。 这可能意味着Adobe Campaign中的字符串更短或整数更小。

### 字段选择{#choice-of-fields}

如果字段具有定位或个性化目的，则需要将其存储在表中。 换句话说，如果字段不用于发送个性化电子邮件或用作查询中的标准，则会占用磁盘空间，而它是无用的。

对于混合型和预置型实例，联合数据访问(联合数据访问，允许访问外部数据的可选功能)涵盖在活动过程中“实时”添加字段的需要。 如果您有联合数据访问，则无需导入所有内容。 有关详细信息，请参阅[联合数据访问](../connect/fda.md)。

### 键选择{#choice-of-keys}

除了大多数表中默认定义的&#x200B;**autouuid**&#x200B;之外，您还应考虑添加一些逻辑或业务密钥（帐户号、客户端号等）。 它可以稍后用于导入/对帐或数据包。 有关详细信息，请参阅[Identifiers](#identifiers)。

高效的密钥对性能至关重要。 数字数据类型应始终作为表的键。

<!-- ### Dedicated tablespaces {#dedicated-tablespaces}

The tablespace attribute in the schema allows you to specify a dedicated tablespace for a table.

The installation wizard allows you to store objects by type (data, temporary).

Dedicated tablespaces are better for partitioning, security rules, and allow fluid and flexible administration, better optimization, and performance. -->

## 标识符{#identifiers}

Adobe Campaign资源具有三个标识符，并且可以添加附加标识符。

下表说明了这些标识符及其用途。

| 标识符 | 说明 | 最佳实践 |
|--- |--- |--- |
| ID | <ul><li>id是Adobe Campaign表的物理主键。 对于内置表，它是通用唯一ID(UUID)</li><li>此标识符必须唯一。 </li><li>UUID可以在模式定义中显示。</li></ul> | <ul><li>自动生成的标识符不应用作工作流或包定义中的引用。</li><li>表中的id是UUID，不应更改此类型。</li></ul> |
| 名称（或内部名称） | <ul><li>此信息是表中记录的唯一标识符。 此值可以手动更新，通常使用生成的名称。</li><li>此标识符在部署到其他Adobe Campaign实例时会保留其值，它不应为空。</li></ul> | <ul><li>如果要将对象从Adobe Campaign部署到另一个环境，请重命名由生成的记录名称。</li><li>当对象具有命名空间属性(例如&#x200B;*模式*)时，将在所有创建的自定义对象中利用此常用命名空间。 不应使用某些保留命名空间:*nms*、*xtk*。</li><li>当对象没有任何命名空间(例如&#x200B;*workflow*&#x200B;或&#x200B;*投放*)时，将添加此命名空间概念作为内部名称对象的前缀：*namespaceMyObjectName*。</li><li>请勿使用空格&quot; &quot;、半列&quot;:&quot;或连字符&quot;-&quot;等特殊字符。 所有这些字符将替换为下划线&quot;_&quot;（允许的字符）。 例如，“abc-def”和“abc:def”将存储为“abc_def”并互相覆盖。</li></ul> |
| 标签 | <ul><li>标签是Adobe Campaign中对象或记录的业务标识符。</li><li>此对象允许使用空格和特殊字符。</li><li>它不保证记录的唯一性。</li></ul> | <ul><li>建议确定对象标签的结构。</li><li>这是最易用的解决方案，用于为Adobe Campaign用户标识记录或对象。</li></ul> |

Adobe Campaign主键是所有内置表的自动生成的UUID，对于自定义表可以是相同的。

即使ID数量是无限的，您也应该考虑数据库的大小以确保最佳性能。 要防止出现任何问题，请确保调整实例清除设置。 有关更多信息，请参阅[此章节](#data-retention)。


## 自定义内部键{#custom-internal-keys}

在Adobe Campaign中创建的每个表都需要主键。

大多数组织都从外部系统导入记录。 虽然收件人表的物理键是“id”属性，但也可以确定自定义键。

此自定义键是外部系统馈送Adobe Campaign中的实际记录主键。

创建自定义表时，有两个选项：
* 自动生成的键(id)和内部键（自定义）的组合。 如果系统键是复合键或不是整数，则此选项很有意思。 整数在大表中提供更高的性能，并与其他表连接。
* 使用主键作为外部系统主键。 此解决方案通常是首选的，因为它通过不同系统之间的一致密钥简化了数据导入和导出的方法。 如果键名为“id”，并且应使用外部值（而非自动生成）填充，则应禁用autouuid。

>[!CAUTION]
>
>autouuid不应用作工作流中的引用。


## 链接和基数{#links-and-cardinality}

### 链接 {#links}

谨防大桌上的“自身”诚信。 删除具有“自有”完整性的宽表的记录可以停止实例。 表已锁定，删除操作逐个完成。 因此，最好在具有大卷的子表上使用“中立”完整性。

声明链接为外部连接不利于性能。 零ID记录模拟外部连接功能。 如果链接使用autouuid，则无需声明外部连接。

虽然可以在工作流中加入任何表，但Adobe建议直接在数据结构定义中定义资源之间的公用链接。

链接的定义应与表中的实际数据保持一致。 错误的定义可能会影响通过链接检索到的数据，例如意外重复记录。

使用表名一致地命名链接：链接名称应有助于了解远程表的内容。

请勿将链接命名为后缀为“id”。 例如，将其命名为“transaction”而不是“transactionId”。

默认情况下，Adobe Campaign将使用外部表的主键创建链接。 更清楚地说，最好在链接定义中显式定义连接。

### 基数{#cardinality}

在设计链接时，请确保声明1-1关系时目标记录是唯一的。 否则，当仅需要一条记录时，连接可能会返回多个记录。 这会在准备投放时导致“查询返回的行数比预期的多”出现错误。 将链接名称设置为与目标模式相同的名称。

在(1)侧的模式中定义带基数(1-N)的链接。 例如，应在事务处理收件人中定义关系模式(1)-(N)事务处理。

请注意，默认情况下，链接的反向基数为(N)。 可以通过向链接定义中添加属性revCardinality=&#39;single&#39;来定义链接(1-1)。

如果用户不能看到反向链接，则可以使用链接定义revLink=&#39;_NONE_&#39;隐藏它。 这的一个好用例是定义从收件人到最后完成的事务的链接。 您只需查看从收件人到最后一个事务的链接，无需从事务表中看到任何反向链接。

执行外部连接(1-0.1)的链接应谨慎使用，因为它将影响系统性能。

## 数据保留 {#data-retention}

Adobe Campaign既不是data warehouse，也不是报告工具。 因此，为确保Adobe Campaign解决方案的良好性能，数据库增长应保持可控。 为此，遵循以下一些最佳实践可能会有所帮助。

关于保留时间，Campaign 中的内置日志表具有预设的保留期，通常将其数据存储限制为 6 个月或更短时间。

以下是内置表的默认保留时间值。请注意，保留时间配置由 Adobe 技术管理员在实施期间设置，每项实施的值可能因客户要求而异。

* **整合跟踪**：1 年
* **投放日志**：6 个月
* **跟踪日志**：1 年
* **已删除的投放**：1 周
* **被拒绝的导入内容**：6 个月
* **访客用户档案**：1 个月
* **优惠建议**：1 年
* **事件**：1 个月
* **事件处理统计信息**：1 年
* **存档事件**：1 年
* **已忽略的渠道事件**：1 个月

>[!CAUTION]
>
>自定义表不会使用标准清除过程进行清除。 尽管在第一天可能不需要执行此操作，但不要忘记为自定义表构建清除流程，因为这可能会导致性能挑战。

有几种解决方案可以最大限度地减少对Adobe Campaign记录的需求：
* 将data warehouse导出到Adobe Campaign之外。
* 生成汇总值，这些值在满足您的营销实践需求的同时占用较少空间。 例如，您不需要Adobe Campaign中完整的客户交易记录历史记录来跟踪上次购买。

您可以在模式中声明“deleteStatus”属性。 将记录标记为已删除，然后在清除任务中延迟删除更为有效。

:speech_balloon:作为受管理的Cloud Services用户，请联系Adobe顾问或技术管理员，了解有关保留的更多信息，或者您是否需要为自定义表设置保留。

## 性能{#performance}

为确保在任何时间都能获得更好的性能，请遵循以下最佳实践。

### 一般建议 {#general-recommendations}

* 避免在查询中使用“CONTAINS”等操作。 如果您知道需要什么并希望筛选对象，请对“EQUAL TO”或其他特定筛选器运算符应用相同的条件。
* 尝试确保诸如导入和导出等流程在工作时间外完成。
* 确保每日所有活动都有计划，并坚持计划。
* 如果每天有一个或几个进程失败，并且如果强制要求在同一天运行该进程，请确保在启动手动进程时没有运行冲突进程，因为这可能会影响系统性能。
* 确保在导入过程中或执行任何手动过程时，不运行任何每日活动。
* 使用一个或多个引用表，而不是在每行中复制字段。 使用键/值对时，最好选择数字键。
* 短字符串仍可接受。 如果外部系统中已有引用表，则重用引用表将有助于数据与Adobe Campaign的集成。

### 一对多关系{#one-to-many-relationships}

* 数据设计会影响可用性和功能。 如果您设计的数据模型具有许多一对多关系，则用户在应用程序中构建有意义的逻辑将更加困难。 对于非技术营销人员而言，一对多过滤逻辑可能难以正确构建和理解。
* 将所有基本字段放在一个表中是件好事，因为它使用户更容易构建查询。 有时，如果可以避免连接，则在表中重复某些字段也会对性能有好处。
* 某些内置功能将不能引用一对多关系，例如优惠加权公式和投放。

## 大表{#large-tables}

Adobe Campaign依赖第三方数据库引擎。 根据提供程序的不同，为较大的表优化性能可能需要特定的设计。

以下是在使用大表和复杂连接设计数据模型时应遵循的一些常见最佳实践。

* 使用其他自定义收件人表时，请确保每个投放映射都有专用的日志表。
* 减少列数，特别是通过识别未使用的列数。
* 通过避免复杂连接（如多个条件和/或多个列上的连接）来优化数据模型关系。
* 对于联接键，请始终使用数字数据而不是字符串。
* 尽可能减少日志保留深度。 如果需要更深入的历史记录，您可以聚合计算和/或处理自定义日志表以存储更大的历史记录。

### 表{#size-of-tables}的大小

表大小是记录数和每个记录的列数的组合。 两者都会影响查询的性能。

* **小型**&#x200B;表与投放表类似。
* **中等大小**&#x200B;表与收件人表的大小相同。 每位客户只有一份记录。
* **large-size**表与“广泛”日志表类似。 每位客户都有许多记录。
例如，如果您的收件人库包含1000万个投放，则Broad日志表包含约1亿到2亿条消息，而表包含几千条记录。

行数也会影响性能。 Adobe Campaign数据库并非设计用于存储不主动用于定位或个性化目的的历史数据 — 这是一个操作数据库。

要防止与高行数相关的任何性能问题，请仅在数据库中保留必要记录。 任何其他记录应导出到第三方data warehouse并从Adobe Campaign操作数据库中删除。

以下是有关表大小的一些最佳实践：

* 设计字段更少、数字数据更多的大型表。
* 请勿使用大数量类型的列来存储小数字（如布尔值）。
* 从表定义中删除未使用的列。
* 请勿将历史或非活动数据保留在Adobe Campaign数据库中（导出和清理）。
